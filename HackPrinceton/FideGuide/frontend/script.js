// Modal Content Data
const modalContent = {
    investment: {
        title: 'Stock Analysis Tools',
        content: `
            <h3>Comprehensive Stock Analysis</h3>
            <p>Available analysis tools:</p>
            <ul>
                <li>Price trends and patterns</li>
                <li>Volume analysis</li>
                <li>Fundamental metrics</li>
                <li>Comparative analysis</li>
            </ul>
        `
    },
    market: {
        title: 'Trendning Stocks',
        content: `
            <h3>How to Find Trending Stocks</h3>
            <ol>
                <li><strong>Use Stock Screener Tools:</strong> Tools like Yahoo Finance, Finviz, and TradingView provide stock screeners with customizable filters. Set filters based on trending indicators like "Top Gainers," "Most Active," "Volume," or "Momentum."</li>
                <li><strong>Analyze Social Media Sentiment:</strong> Platforms like Reddit (e.g., r/WallStreetBets) and Twitter often discuss trending stocks. Tools like StockTwits or dedicated sentiment analysis platforms (e.g., Market Chameleon or Tickeron) aggregate social media sentiment data.</li>
                <li><strong>Look at Pre-market and After-hours Movers:</strong> Trending stocks often show unusual activity outside regular trading hours. Use resources like Nasdaq's "After-Hours" and "Pre-Market" movers lists to identify stocks that may trend the next day.</li>
                <li><strong>Track High Volume and High Volatility Stocks:</strong> High volume indicates heavy trading interest, often pointing toward a trending stock. High volatility can indicate significant price changes, often due to recent news or events. Use stock screeners to filter by volume and volatility.</li>
                <li><strong>Check Out Financial News and Updates:</strong> Financial news websites like CNBC, Bloomberg, and MarketWatch often have lists of trending stocks based on current events. Google News also has a "Trending Stocks" section for stocks frequently mentioned in the news.</li>
                <li><strong>Use Google Trends for Keywords:</strong> Search for trending stock-related keywords on Google Trends to gauge which stocks have rising interest among the public. Compare search interest for companies, especially in sectors experiencing recent popularity.</li>
                <li><strong>Monitor Analyst Reports and Price Target Changes:</strong> Analyst upgrades or downgrades can spark interest in stocks, making them trend. Platforms like Seeking Alpha and Yahoo Finance display recent analyst recommendations and price target changes.</li>
                <li><strong>Keep an Eye on Earnings Reports and Corporate Announcements:</strong> Stocks often trend due to quarterly earnings announcements or significant news like mergers, acquisitions, or new product launches. Use an earnings calendar (like those on Yahoo Finance or TradingView) to find companies with upcoming announcements.</li>
            </ol>
        `
    },

        marketPositioning: {
            title: 'Comprehensive Guide to Understanding Market Position',
            content: `
                <h3>Step-by-Step Approach to Analyze Market Position</h3>
                <ol>
                    <li><strong>Define Your Target Market and Audience:</strong> Identify your target market by segmenting the larger market into smaller groups based on demographics, interests, and purchasing behavior. Understand customer needs by analyzing data, conducting surveys, and observing trends. Define the target audience clearly to compare your product’s appeal versus competitors.</li>
                    <li><strong>Identify Competitors:</strong> List direct competitors (those with similar products/services) and indirect competitors (those with substitute products). Use industry reports and tools like SEMrush or SimilarWeb, and social media to track competitors by market share, revenue, and offerings.</li>
                    <li><strong>Analyze Competitor Offerings and Market Share:</strong> Study competitors' products to understand their unique selling points (USPs), pricing, and benefits. Estimate market share using reports and customer reviews to gauge customer preferences.</li>
                    <li><strong>Determine Your Unique Value Proposition (UVP):</strong> Based on customer needs and competitor offerings, define what makes your product unique or superior. Focus on price, quality, features, service, or reputation to align positioning with your UVP.</li>
                    <li><strong>Perform a SWOT Analysis:</strong> Identify Strengths (advantages over competitors), Weaknesses (areas for improvement), Opportunities (market gaps or trends), and Threats (competitive pressures or regulatory changes).</li>
                    <li><strong>Map the Competitive Landscape:</strong> Create a positioning map (e.g., 2x2 matrix) to plot competitors on key dimensions like price vs. quality or customer service vs. innovation. Visualize your brand's unique position on this map.</li>
                    <li><strong>Evaluate Customer Perception of Your Brand:</strong> Conduct surveys or sentiment analysis to understand current brand perception. Measure brand loyalty and satisfaction through Net Promoter Scores (NPS) or customer feedback.</li>
                    <li><strong>Refine Positioning Statement:</strong> Develop a concise statement articulating your market position, addressing who you serve, how you solve their problem, and what sets you apart. Ensure alignment with customer needs and differentiation from competitors.</li>
                    <li><strong>Implement and Monitor:</strong> Apply your positioning in marketing, product development, and customer service. Track metrics like market share, customer acquisition/retention, and feedback, adapting as needed to remain aligned with the market.</li>
                </ol>
                <p>Following these steps can help you precisely understand your market position, find growth areas, and create a distinct brand strategy.</p>
            `
        },
        
    technical: {
            title: 'Step-by-Step Guide to Analyzing Market Position',
            content: `
                <h3>Understanding Market Position</h3>
                <p>This guide provides a structured approach to analyze where a company, product, or service stands relative to competitors in a given market.</p>
                <ol>
                    <li><strong>Define Your Target Market and Audience:</strong> Segment the larger market into smaller groups based on demographics, interests, and purchasing behavior. Use data analysis, surveys, and trend observation to understand customer needs and preferences, which helps focus on customer pain points and desires.</li>
                    <li><strong>Identify Competitors:</strong> List direct competitors (those selling similar products/services) and indirect competitors (those with substitute products). Track competitors using industry reports, tools like SEMrush or SimilarWeb, and social media. Classify competitors by market share, revenue, and product offerings.</li>
                    <li><strong>Analyze Competitor Offerings and Market Share:</strong> Study competitors' products to understand unique selling points (USPs), pricing, and product benefits. Use industry reports and customer feedback to estimate market share and gain insight into customer preferences.</li>
                    <li><strong>Determine Your Unique Value Proposition (UVP):</strong> Define what makes your product unique or better based on customer needs and competitor offerings. Focus on factors like price, quality, features, customer service, or brand reputation.</li>
                    <li><strong>Perform a SWOT Analysis (Strengths, Weaknesses, Opportunities, Threats):</strong> Identify strengths (e.g., quality, brand), weaknesses (e.g., price, features), opportunities (e.g., market gaps), and threats (e.g., competitive pressures, regulatory changes).</li>
                    <li><strong>Map the Competitive Landscape:</strong> Create a positioning map (e.g., 2x2 matrix) to plot competitors on key dimensions like price vs. quality or customer service vs. innovation. This visualization helps identify if your brand occupies a unique space.</li>
                    <li><strong>Evaluate Customer Perception of Your Brand:</strong> Use surveys, focus groups, or sentiment analysis to understand brand perception. Measure loyalty and satisfaction through metrics like Net Promoter Scores (NPS) or customer feedback.</li>
                    <li><strong>Refine Positioning Statement:</strong> Develop a clear positioning statement that defines who you serve, how you solve their problem, and what sets you apart. Ensure alignment with customer needs and differentiation from competitors.</li>
                    <li><strong>Implement and Monitor:</strong> Roll out positioning across marketing, product development, and customer service. Track metrics like market share, customer acquisition, and feedback, adjusting as needed based on market or competitor changes.</li>
                </ol>
                <p>Following these steps allows a precise understanding of market position, helping identify growth areas and crafting a distinct brand strategy.</p>
            `
        },
        
        financialAnalysisGuide: {
            title: 'Step-by-Step Guide to Reading Financial Statements',
            content: `
                <h3>Comprehensive Guide to Analyzing Financial Statements</h3>
                <p>This guide breaks down each part of a company’s financial statements, including the income statement, balance sheet, and cash flow statement, to help you assess financial health and performance.</p>
                <ol>
                    <li><strong>Start with the Income Statement:</strong> The income statement shows profitability over a period. Key elements include:
                        <ul>
                            <li><strong>Revenue (Sales):</strong> Total income from business operations. Compare over time to assess growth.</li>
                            <li><strong>Cost of Goods Sold (COGS):</strong> Direct costs associated with producing goods or services.</li>
                            <li><strong>Gross Profit:</strong> Revenue minus COGS. Reflects profitability after direct costs.</li>
                            <li><strong>Operating Expenses:</strong> Expenses like R&D and administrative costs.</li>
                            <li><strong>Operating Income (EBIT):</strong> Gross profit minus operating expenses.</li>
                            <li><strong>Net Income:</strong> Bottom line after all expenses, indicating actual profitability.</li>
                            <li><strong>Earnings Per Share (EPS):</strong> Net income divided by shares outstanding.</li>
                        </ul>
                    </li>
                    <li><strong>Examine the Balance Sheet:</strong> Shows assets, liabilities, and equity at a specific time.
                        <ul>
                            <li><strong>Assets:</strong> Current assets (convertible to cash within a year) and long-term assets.</li>
                            <li><strong>Liabilities:</strong> Current (due within a year) and long-term liabilities.</li>
                            <li><strong>Debt-to-Equity Ratio:</strong> Total liabilities divided by shareholders’ equity.</li>
                            <li><strong>Shareholders' Equity:</strong> Residual interest in assets after deducting liabilities.</li>
                        </ul>
                    </li>
                    <li><strong>Analyze the Cash Flow Statement:</strong> Details cash inflows and outflows in three areas.
                        <ul>
                            <li><strong>Operating Cash Flow:</strong> Cash from core operations; growth here indicates business health.</li>
                            <li><strong>Investing Cash Flow:</strong> Cash used for or generated by investments.</li>
                            <li><strong>Financing Cash Flow:</strong> Cash from investors or creditors.</li>
                            <li><strong>Net Change in Cash:</strong> Shows if cash on hand is increasing or decreasing.</li>
                        </ul>
                    </li>
                    <li><strong>Look at Financial Ratios:</strong> Ratios help assess financial health.
                        <ul>
                            <li><strong>Liquidity Ratios:</strong> Current Ratio measures ability to cover short-term obligations.</li>
                            <li><strong>Profitability Ratios:</strong> Net Profit Margin indicates overall profitability.</li>
                            <li><strong>Efficiency Ratios:</strong> Inventory Turnover shows asset utilization efficiency.</li>
                            <li><strong>Leverage Ratios:</strong> Debt-to-Equity Ratio reflects financial structure and risk.</li>
                        </ul>
                    </li>
                    <li><strong>Compare to Industry and Historical Performance:</strong> Compare ratios and growth to industry standards and analyze trends over time for growth stability.</li>
                    <li><strong>Check the Notes and Management Discussion:</strong> Notes and management discussion provide context on accounting policies, unusual transactions, and future outlook.</li>
                </ol>
                <p>Following these steps offers a detailed understanding of a company’s financial health and operational performance.</p>
            `
        },
        
        tradingGuide: {
            title: 'Guide to Executing Trades and Understanding Order Types',
            content: `
                <h3>Step-by-Step Guide to Trading and Order Types</h3>
                <p>This guide provides a breakdown of essential steps for executing trades and understanding different order types in financial markets.</p>
                <ol>
                    <li><strong>Understanding What a Trade Is:</strong> A trade is the buying or selling of assets (stocks, currencies, etc.) between a buyer and a seller. To trade, select a brokerage platform and understand order types, which specify the conditions for execution.</li>
                    <li><strong>Getting to Know Basic Terms:</strong>
                        <ul>
                            <li><strong>Bid Price:</strong> Highest price a buyer is willing to pay.</li>
                            <li><strong>Ask Price:</strong> Lowest price a seller will accept.</li>
                            <li><strong>Spread:</strong> Difference between bid and ask prices, representing the trade cost.</li>
                        </ul>
                    </li>
                    <li><strong>Setting Up Your Account & Choosing Assets:</strong> Create a trading account on a brokerage platform, research assets, and understand their trends, volatility, and fundamentals.</li>
                    <li><strong>Understanding Different Order Types:</strong> Order types set conditions for buying/selling.
                        <ul>
                            <li><strong>Market Order:</strong> Executes immediately at the best price available. Best for quick trades.</li>
                            <li><strong>Limit Order:</strong> Executes only at a specified price or better, ideal for controlling trade price.</li>
                            <li><strong>Stop Order (Stop-Loss Order):</strong> Automatically sells/buys if a certain price is reached, minimizing loss or securing profit.</li>
                            <li><strong>Stop-Limit Order:</strong> Combines stop and limit orders for greater control in volatile markets.</li>
                            <li><strong>Trailing Stop Order:</strong> Adjusts stop price as asset price moves favorably, locking in profits.</li>
                        </ul>
                    </li>
                    <li><strong>Placing an Order:</strong> Select the order type, specify details (shares, stop/limit price), and confirm.</li>
                    <li><strong>Monitoring Your Trade:</strong> Track order status and market movements, adjusting orders if needed.</li>
                    <li><strong>Closing or Modifying Orders:</strong> Some platforms allow modifying or canceling orders as market conditions change.</li>
                    <li><strong>Understanding Risks and Strategy:</strong> Each order type has specific purposes and risks. Choose based on goals, risk tolerance, and market conditions for successful trading.</li>
                </ol>
                <p>Mastering these order types improves trading efficiency and aligns strategies with market dynamics.</p>
            `
        },

        portfolioManagementGuide: {
            title: 'Comprehensive Guide to Evaluating Stock Performance and Managing a Portfolio',
            content: `
                <h3>Step-by-Step Guide to Portfolio Management</h3>
                <p>This guide covers the essential steps for evaluating stock performance and managing a diversified portfolio aligned with your goals and risk tolerance.</p>
                <ol>
                    <li><strong>Define Investment Goals and Risk Tolerance:</strong> 
                        <ul>
                            <li><strong>Investment Goals:</strong> Determine objectives (e.g., growth, income) and timeframes (short-term, long-term).</li>
                            <li><strong>Risk Tolerance:</strong> Assess factors like age, income stability, and comfort with losses to define your risk level.</li>
                        </ul>
                    </li>
                    <li><strong>Research and Analyze Individual Stocks:</strong>
                        <ul>
                            <li><strong>Fundamental Analysis:</strong> Review financial statements (income, balance sheet, cash flow) and key ratios such as P/E, P/B, ROE, and D/E. Consider qualitative factors like business model and competitive position.</li>
                            <li><strong>Technical Analysis:</strong> Use tools like moving averages, RSI, and Bollinger Bands to analyze stock trends and identify entry/exit points.</li>
                        </ul>
                    </li>
                    <li><strong>Compare Stock Performance Against Benchmarks:</strong>
                        <ul>
                            <li><strong>Benchmark Comparison:</strong> Compare stock performance to market indices (e.g., S&P 500) for perspective on value.</li>
                            <li><strong>Industry Comparison:</strong> Compare metrics against peers in the same sector.</li>
                            <li><strong>Growth Metrics:</strong> Track EPS growth and revenue growth rate to assess long-term potential.</li>
                        </ul>
                    </li>
                    <li><strong>Diversify and Allocate Assets Within the Portfolio:</strong>
                        <ul>
                            <li><strong>Asset Allocation:</strong> Decide how much to allocate to stocks, bonds, etc., based on goals.</li>
                            <li><strong>Sector and Geographical Diversification:</strong> Spread investments across sectors and regions to minimize risks.</li>
                            <li><strong>Stock Selection:</strong> Include a mix of growth, value, and dividend stocks according to strategy.</li>
                        </ul>
                    </li>
                    <li><strong>Regularly Monitor and Re-Evaluate the Portfolio:</strong>
                        <ul>
                            <li><strong>Performance Review:</strong> Regularly assess stock performance against benchmarks and goals.</li>
                            <li><strong>Rebalancing:</strong> Periodically adjust allocations to maintain the desired portfolio balance.</li>
                            <li><strong>Assess Market Conditions:</strong> Stay updated on economic news and trends that may impact stock performance.</li>
                        </ul>
                    </li>
                    <li><strong>Implement Risk Management Strategies:</strong>
                        <ul>
                            <li><strong>Stop-Loss Orders:</strong> Automatically sell stocks at a specific price to limit losses.</li>
                            <li><strong>Hedging with Derivatives:</strong> Use options or futures to hedge against potential downturns.</li>
                            <li><strong>Position Sizing:</strong> Limit exposure to any single stock to reduce potential impacts.</li>
                        </ul>
                    </li>
                    <li><strong>Evaluate and Adjust Based on Performance and Changing Goals:</strong>
                        <ul>
                            <li><strong>Overall Performance Review:</strong> Evaluate portfolio returns periodically and make adjustments.</li>
                            <li><strong>Update Goals:</strong> Adjust strategies as financial goals or risk tolerance evolve.</li>
                            <li><strong>Continuous Learning:</strong> Stay informed about new strategies and market trends.</li>
                        </ul>
                    </li>
                </ol>
                <p>By following these steps, you can evaluate stock performance effectively and manage a diversified, goal-aligned portfolio.</p>
            `
        },        

        marketEconomicIndicators: {
            title: 'Evaluating Market and Economic Indicators',
            content: `
                <h3>Understanding Market and Economic Indicators</h3>
                <p>Market and economic indicators provide insights into the overall health of the economy and can signal potential opportunities or risks in the stock market.</p>
                <ol>
                    <li><strong>Key Economic Indicators:</strong> 
                        <ul>
                            <li><strong>Gross Domestic Product (GDP):</strong> Measures the total economic output of a country. A growing GDP generally indicates a healthy economy, which can boost stock performance.</li>
                            <li><strong>Inflation Rate:</strong> Shows the rate at which prices for goods and services rise. High inflation can erode purchasing power and affect company profits.</li>
                            <li><strong>Unemployment Rate:</strong> Indicates the percentage of the workforce that is unemployed. Lower unemployment usually reflects economic strength, which can benefit the stock market.</li>
                            <li><strong>Interest Rates:</strong> Set by central banks, interest rates affect borrowing costs for companies. Lower rates can encourage investment and spending, while higher rates may slow economic growth.</li>
                        </ul>
                    </li>
                    <li><strong>Market Sentiment Indicators:</strong>
                        <ul>
                            <li><strong>Volatility Index (VIX):</strong> Known as the "fear gauge," the VIX measures expected market volatility. Higher values often indicate uncertainty, which can lead to market instability.</li>
                            <li><strong>Market Breadth:</strong> Refers to the number of stocks advancing versus declining in a market index. Strong market breadth suggests healthy, broad-based market performance.</li>
                            <li><strong>Consumer Confidence Index (CCI):</strong> Measures consumers' confidence in the economy, often influencing their spending behavior and impacting sectors like retail and services.</li>
                        </ul>
                    </li>
                    <li><strong>Applying Indicators to Stock Analysis:</strong> Understanding these indicators helps investors anticipate potential impacts on their portfolio. For instance, rising interest rates might lead to adjustments in interest-sensitive sectors (like real estate or utilities), while high consumer confidence can boost sectors reliant on consumer spending.</li>
                </ol>
                <p>Incorporating market and economic indicators into your stock analysis can help you make informed decisions based on both company performance and broader market trends.</p>
            `
        }
        
};

// DOM Elements
const buttons = document.querySelectorAll('.action-button');
const modal = document.querySelector('.modal');
const modalOverlay = document.querySelector('.modal-overlay');
const closeModal = document.querySelector('.close-modal');
const modalTitle = document.querySelector('.modal h2');
const modalBody = document.querySelector('.modal-body');
const chatMessages = document.querySelector('.chat-messages');

// Button Hover Effects
buttons.forEach(button => {
    button.addEventListener('mousemove', (e) => {
        const rect = button.getBoundingClientRect();
        const x = e.clientX - rect.left;
        const y = e.clientY - rect.top;
        
        const glow = button.querySelector('.button-glow');
        glow.style.left = `${x}px`;
        glow.style.top = `${y}px`;
    });

    button.addEventListener('click', () => {
        const category = button.getAttribute('data-category');
        openModal(category);
    });
});

// Modal Functions
function openModal(category) {
    const content = modalContent[category];
    if (!content) return;

    modalTitle.textContent = content.title;
    modalBody.innerHTML = content.content;
    modal.classList.add('active');
    modalOverlay.classList.add('active');
}

// Close modal events
closeModal.addEventListener('click', closeModalFunction);
modalOverlay.addEventListener('click', closeModalFunction);

function closeModalFunction() {
    modal.classList.remove('active');
    modalOverlay.classList.remove('active');
}

// Chat Functions
function sendMessage() {
    const userInput = document.getElementById('user-input').value;

    if (userInput.trim() === "") return;

    // Display user message
    appendMessage('user-message', userInput);

    // Send to backend
    fetch('http://127.0.0.1:5000/chat', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
        },
        body: JSON.stringify({ message: userInput })
    })
    .then(response => response.json())
    .then(data => {
        appendMessage('bot-message', data.response);
    })
    .catch(error => {
        console.error('Error:', error);
        appendMessage('bot-message', 'Sorry, I encountered an error. Please try again.');
    });

    // Clear input
    document.getElementById('user-input').value = '';
}

function appendMessage(className, text) {
    const messageDiv = document.createElement('div');
    messageDiv.className = `message ${className}`;
    messageDiv.textContent = text;
    chatMessages.appendChild(messageDiv);
    chatMessages.scrollTop = chatMessages.scrollHeight;
}

// Enter key support
document.getElementById('user-input').addEventListener('keypress', function(e) {
    if (e.key === 'Enter' && !e.shiftKey) {
        e.preventDefault();
        sendMessage();
    }
});

// Auto-resize textarea
const textarea = document.getElementById('user-input');
textarea.addEventListener('input', function() {
    this.style.height = 'auto';
    this.style.height = (this.scrollHeight) + 'px';
});